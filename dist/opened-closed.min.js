"use strict";var OpenedClosed=function(){function t(e){if(!this._isObject(e))throw new Error(t.ERR_OPTIONS_NOT_OBJECT);if(0===Object.keys(e).length)throw new Error(t.ERR_OPTIONS_EMPTY);if("timezone"in e==!1)throw new Error(t.ERR_OPTIONS_MISSING_TIMEZONE);this._options=e,this.now=new Date,this._throwErrorIfClosingDateIncorrect(),this._throwErrorIfOpeningDateIncorrect(),this._autoFillLanguage()}return t.prototype.opened=function(){var t=!1,e=this._now();for(var r in this._options.openings)for(var o=0,n=this._options.openings[r];o<n.length;o++){var i=n[o],_=this._getDateFromString(i.start),s=this._getDateFromString(i.end),a=this._nowIsClosed();if(this._nowIsTheDay(r)&&this._dateBetween(e,_,s)&&!a){t=!0;break}}return t},t.prototype.availability=function(){var t=this._options.language.closed;return!0===this.opened()&&(t=this._options.language.opened),t},t.prototype.closeIn=function(){var t=[],e=this._now();for(var r in this._options.openings)for(var o=0,n=this._options.openings[r];o<n.length;o++){var i=n[o],_=this._getDateFromString(i.start),s=this._getDateFromString(i.end);if(this._nowIsTheDay(r)&&this._dateBetween(e,_,s)){var a=this._datesDifferenceToEpoch(e,s);t.push(a);break}}return this._max(t)},t.prototype.closeAt=function(){var t=new Date,e=this._now();for(var r in this._options.openings)for(var o=0,n=this._options.openings[r];o<n.length;o++){var i=n[o],_=this._getDateFromString(i.start),s=this._getDateFromString(i.end);if(this._nowIsTheDay(r)&&this._dateBetween(e,_,s)){t=s;break}}return t},t.prototype._currentYear=function(){return this.now.getFullYear()},t.prototype._currentMonth=function(){return this.now.getMonth()+1},t.prototype._currentDay=function(){return this.now.getDate()},t.prototype._dayNow=function(){return this.now.getDay()},t.prototype._now=function(){return new Date},t.prototype._currentDate=function(t){return t.year+"-"+t.month+"-"+t.day+" "+t.time+" "+this._options.timezone},t.prototype._getDateFromString=function(e){if(!this._isString(e))throw new Error(t.ERR_TIME_SHOULD_BE_STRING);if(0===e.length)throw new Error(t.ERR_TIME_NOT_CORRECT);var r=this._currentYear(),o=this._currentMonth(),n=this._currentDay(),i=this._currentDate({year:r,month:o,day:n,time:e}),_=new Date(i);if(isNaN(_.getTime()))throw new Error(t.ERR_TIME_NOT_CORRECT);return new Date(i)},t.prototype._dayNumberFromString=function(e){var r=0;switch(e){case"sunday":r=0;break;case"monday":r=1;break;case"tuesday":r=2;break;case"wednesday":r=3;break;case"thursday":r=4;break;case"friday":r=5;break;case"saturday":r=6;break;default:throw new Error(t.ERR_UNSUPPORTED_DAY)}return r},t.prototype._nowIsTheDay=function(t){var e=this._dayNumberFromString(t);return this._dayNow()===e},t.prototype._autoFillLanguage=function(){if("language"in this._options!=!1){var e=this._options.language;if(!this._isObject(e))throw new Error(t.ERR_OPTIONS_LANGUAGE_NOT_OBJECT);"opened"in this._options.language==!1&&(this._options.language.opened=t.DEFAULT_LANGUAGE_OPENED);var r=this._options.language.opened;if(!this._isString(r))throw new Error(t.ERR_OPTIONS_LANGUAGE_OPENED_NOT_STRING);if(0===r.trim().length)throw new Error(t.ERR_OPTIONS_LANGUAGE_OPENED_EMPTY);"closed"in this._options.language==!1&&(this._options.language.closed=t.DEFAULT_LANGUAGE_CLOSED);var o=this._options.language.closed;if(!this._isString(o))throw new Error(t.ERR_OPTIONS_LANGUAGE_CLOSED_NOT_STRING);if(0===o.trim().length)throw new Error(t.ERR_OPTIONS_LANGUAGE_CLOSED_EMPTY)}else this._options.language={opened:"opened",closed:"closed"}},t.prototype._dateToEpoch=function(e){if(!this._isDate(e))throw new Error(t.ERR_INTERNAL_NOT_DATE);var r=e.getTime()/1e3;return r=parseInt(r.toString())},t.prototype._datesDifferenceToEpoch=function(t,e){var r=this._dateToEpoch(t);return this._dateToEpoch(e)-r},t.prototype._max=function(e){if(!this._isArray(e))throw new Error(t.ERR_INTERNAL_NOT_ARRAY);return 0===e.length?0:Math.max.apply(Math,e)},t.prototype._nowIsClosed=function(){var t=!this._hasOpenings(),e=this._options.closings,r=this._now();if(this._isArray(e))for(var o=0,n=e;o<n.length;o++){var i=n[o];if(this._dateBetween(r,i.from,i.to)){t=!0;break}}return t},t.prototype._throwErrorIfClosingDateIncorrect=function(){var e="closings"in this._options?this._options.closings:void 0;if(this._isArray(e))for(var r=0,o=e;r<o.length;r++){var n=o[r];if(!this._isObject(n))throw new Error(t.ERR_CLOSINGS_DATE_NOT_OBJECT);if("from"in n==!1)throw new Error(t.ERR_MISSING_FROM_KEY);if("to"in n==!1)throw new Error(t.ERR_MISSING_TO_KEY);var i=n.from,_=n.to;if(!this._isDate(i))throw new Error(t.ERR_KEY_FROM_NOT_DATE);if(!this._isDate(_))throw new Error(t.ERR_KEY_TO_NOT_DATE)}else if(null!=e)throw new Error(t.ERR_MALFORMED_CLOSINGS)},t.prototype._throwErrorIfOpeningDateIncorrect=function(){var e=this._options.openings;if(this._isObject(e))for(var r in e){var o=e[r];if(!this._isArray(o))throw new Error(t.ERR_MALFORMED_OPENINGS);for(var n=0,i=o;n<i.length;n++){var _=i[n];if(!this._isObject(_))throw new Error(t.ERR_MALFORMED_OPENINGS);if(!("start"in _&&"end"in _))throw new Error(t.ERR_MALFORMED_OPENINGS);this._getDateFromString(_.start),this._getDateFromString(_.end)}}else if(null!=e)throw new Error(t.ERR_MALFORMED_OPENINGS)},t.prototype._dateBetween=function(t,e,r){return e<=t&&t<=r},t.prototype._isNull=function(t){return null===t},t.prototype._isUndefined=function(t){return void 0===t},t.prototype._isDate=function(t){return!this._isNull(t)&&!this._isUndefined(t)&&t.constructor===Date},t.prototype._isObject=function(t){return!this._isNull(t)&&!this._isUndefined(t)&&t.constructor===Object},t.prototype._isArray=function(t){return!this._isNull(t)&&!this._isUndefined(t)&&t.constructor===Array},t.prototype._isString=function(t){return!this._isNull(t)&&!this._isUndefined(t)&&t.constructor===String},t.prototype._hasOpenings=function(){return"openings"in this._options&&Object.keys(this._options.openings).length>0},t.ERR_OPTIONS_NOT_OBJECT="expected parameter 1 to be an object",t.ERR_OPTIONS_EMPTY="options is empty",t.ERR_OPTIONS_MISSING_TIMEZONE="options is missing timezone",t.ERR_OPTIONS_LANGUAGE_NOT_OBJECT="language options should be an object",t.ERR_OPTIONS_LANGUAGE_OPENED_NOT_STRING="opened language is string",t.ERR_OPTIONS_LANGUAGE_OPENED_EMPTY="opened language is empty",t.ERR_OPTIONS_LANGUAGE_CLOSED_NOT_STRING="closed language is string",t.ERR_OPTIONS_LANGUAGE_CLOSED_EMPTY="closed language is empty",t.ERR_UNSUPPORTED_DAY="unsupported day",t.ERR_MISSING_FROM_KEY='key "from" is missing',t.ERR_MISSING_TO_KEY='key "to" is missing',t.ERR_KEY_FROM_NOT_DATE='key "from" should be a Date',t.ERR_KEY_TO_NOT_DATE='key "to" should be a Date',t.ERR_CLOSINGS_DATE_NOT_OBJECT="each closing dates should be an object",t.ERR_MALFORMED_OPENINGS="malformed openings data",t.ERR_MALFORMED_CLOSINGS="malformed closings data",t.ERR_TIME_NOT_CORRECT="the time is not valid",t.ERR_TIME_SHOULD_BE_STRING="the time should be a string",t.ERR_INTERNAL_NOT_DATE="internal error: invalid date",t.ERR_INTERNAL_NOT_ARRAY="internal error: invalid array",t.DEFAULT_LANGUAGE_CLOSED="closed",t.DEFAULT_LANGUAGE_OPENED="opened",t}();